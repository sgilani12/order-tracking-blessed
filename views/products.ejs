<!DOCTYPE html>

<html lang="en">

<%- include('partials/head') %>

    <body>
        <%- include('partials/topbar') %>
            <%- include('partials/side-nav') %>
                <div class="page-content">
                    <div class="table-container">
                        <input class="input" type="text" id="productSearch" onkeyup="searchProduct()"
                            placeholder="Search by name" title="">
                        <table class="table" id="product_table">
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>SKU</th>
                                    <th>Price</th>
                                    <th>Product_Name</th>
                                    <th>Quantity</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% var products=[ { "product_id" : 1, "SKU" : "hjlksadf456481" , "price" :
                                    4.99, "product_name" : "Kanye" , "quantity" : 40, "description" : "this is great" },
                                    { "product_id" : 2, "SKU" : "kuhw54afds5" , "price" : 22.99, "product_name" : "West"
                                    , "quantity" : 20, "description" : "this is cool" } ] %>
                                    <!--object called customers loaded on page render -->
                                    <% if(products.length> 0){ %>

                                        <% for ( var i=0 ; i < products.length ; i++){ %>
                                            <tr>
                                                <td>
                                                    <%= products[i].product_id%>
                                                </td>
                                                <td>
                                                    <%= products[i].SKU%>
                                                </td>
                                                <td>
                                                    <%= products[i].price%>
                                                </td>
                                                <td>
                                                    <%= products[i].product_name%>
                                                </td>
                                                <td>
                                                    <%= products[i].quantity%>
                                                </td>
                                                <td>
                                                    <%= products[i].description%>
                                                </td>
                                                <td>
                                                    <!--delete button, DELTE api call to /customers/:id-->
                                                    <!--let id = '<%- products[i].product_id%>';-->
                                                    <script>
                                                        async function deleteProduct(id) {
                                                            let url = `/products/${id}`;
                                                            confirm(`Deleting Product ${id}`);
                                                            console.log(`endpoint to hit: ${url}`);
                                                            const res = await axios.delete(url);
                                                            console.log(`request status: ${res.status}`);
                                                        }

                                                    </script>

                                                    <a onClick="deleteProduct('<%- products[i].product_id%>')"
                                                        href="">Delete</a>
                                                </td>
                                            </tr>
                                            <% } %>

                                                <% } %>
                            </tbody>
                            <tfoot></tfoot>
                        </table>
                    </div>
                </div>
                <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
                <script>
                    function searchProduct() {
                        var input, filter, table, tr, td, i, txtValue;
                        input = document.getElementById("productSearch");
                        filter = input.value.toUpperCase();
                        table = document.getElementById("product_table");
                        tr = table.getElementsByTagName("tr");
                        for (i = 0; i < tr.length; i++) {
                            td = tr[i].getElementsByTagName("td")[3];
                            if (td) {
                                txtValue = td.textContent || td.innerText;
                                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                    tr[i].style.display = "";
                                } else {
                                    tr[i].style.display = "none";
                                }
                            }
                        }
                    }
                </script>
    </body>

</html>